# Описание программы для вычисления решения астроинерциального режима

Программа представляет собой консольное приложение на C++, которое вычисляет навигационные матрицы на основе введенных пользователем параметров. Она использует два режима: **astro_inertial** (астроинерциальный режим) и **correction** (коррекционный режим). В зависимости от выбранного режима, программа запрашивает у пользователя соответствующие параметры, проводит вычисления и выводит результаты.

## Основная логика программы:

Матрицу $M_{МСК}^{АПСК}$ можно определить перемножением МНК по углам крена $C_\gamma$ , тангажа $C_\vartheta$ и курса $C_\psi$:

$$ M_{МСК}^{АПСК} = C_\gamma \cdot C_\vartheta \cdot C_\psi \$$

где:

$$ C_\gamma = \begin{pmatrix*}
\cos \gamma & 0 & -\sin \gamma \\\
0 & 1 & 0 \\\
\sin \gamma & 0 & \cos \gamma
\end{pmatrix*}$$


$$
C_\vartheta = \begin{pmatrix*}
1 & 0 & 0 \\
0 & \cos \vartheta & \sin \vartheta \\
0 & -\sin \vartheta & \cos \vartheta
\end{pmatrix*}
$$

$$
C_\psi = \begin{pmatrix*}
\cos \psi & -\sin \psi & 0 \\
\sin \psi & \cos \psi & 0 \\
0 & 0 & 1
\end{pmatrix*}
$$

#### Параметры:
- $\gamma$ — угол крена относительно оси Y;
- $\vartheta$ — угол тангажа относительно оси X;
- $\psi$ — угол курса относительно оси Z.

В астроинерциальном режиме осуществляется коррекция выходных параметров АИНС по широте, долготе и курсу, таким образом:

$$
M_{ИСК}^{ЗПСК} = M_{АПСК}^{ЗПСК} \cdot C_\gamma \cdot C_\vartheta \cdot C_\psi \cdot M_{ГСК}^{МСК} \cdot M_{ИСК}^{ГСК}
$$

Отсюда получается основное уравнение астроинерциальной навигации:

$$
C_\psi \cdot M_{ГСК}^{МСК} = (C_\vartheta)^{-1} \cdot (C_\gamma)^{-1} \cdot (M_{АПСК}^{ЗПСК})^{-1} \cdot M_{ИСК}^{ЗПСК} \cdot (M_{ИСК}^{ГСК})^{-1}
$$

## Режимы работы программы

В левой части основного уравнения астронавигации осуществляется решение астроинерциальной задачи по вычислению навигационных параметров широта, долгота и курс (режим 1 - `astro_inertial`). 

### Матрица $M_{АПСК}^{ЗПСК}$

Матрица $M_{АПСК}^{ЗПСК}$ будет иметь вид:

$$
M_{АПСК}^{ЗПСК} =
\begin{pmatrix*}
M_{АПСК}^{ЗПСК_{11}} & M_{АПСК}^{ЗПСК_{12}} & M_{АПСК}^{ЗПСК_{13}} \\
M_{АПСК}^{ЗПСК_{21}} & M_{АПСК}^{ЗПСК_{22}} & M_{АПСК}^{ЗПСК_{23}} \\
M_{АПСК}^{ЗПСК_{31}} & M_{АПСК}^{ЗПСК_{32}} & M_{АПСК}^{ЗПСК_{33}} 
\end{pmatrix*}
$$

где:
- $$ M_{_{11}АПСК}^{_{__}ЗПСК} = \cos \alpha_1 \cdot \cos \alpha_3 + \sin \alpha_1 \cdot \sin \alpha_2 \cdot \sin \alpha_3 $$
- $$M_{_{12}АПСК}^{__ЗПСК} = \sin \alpha_1 \cdot \cos \alpha_2$$
- $$M_{_{13}АПСК}^{___ЗПСК} = -\cos \alpha_1 \cdot \sin \alpha_3 + \sin \alpha_1 \cdot \sin \alpha_2 \cdot \cos \alpha_3$$
- $$M_{_{21}_АПСК}^{ЗПСК} = -\sin \alpha_1 \cdot \cos \alpha_3 + \cos \alpha_1 \cdot \sin \alpha_2 \cdot \sin \alpha_3$$
- $$M_{АПСК}^{ЗПСК_{22}} = \cos \alpha_1 \cdot \cos \alpha_2$$
- $$M_{АПСК}^{ЗПСК_{23}} = \sin \alpha_1 \cdot \sin \alpha_3 + \cos \alpha_1 \cdot \sin \alpha_2 \cdot \cos \alpha_3$$
- $$ M_{АПСК}^{ЗПСК_{31}} = \cos \alpha_2 \cdot \sin \alpha_3 $$
- $$ M_{АПСК}^{ЗПСК_{32}} = -\sin \alpha_2 $$
- $$ M_{АПСК}^{ЗПСК_{33}} = \cos \alpha_2 \cdot \cos \alpha_3 $$

#### Параметры:
- $\alpha_1$ — угол сопряжения звездного датчика и ИНС относительно оси Y;
- $\alpha_2$ — угол сопряжения звездного датчика и ИНС относительно оси Z;
- $\alpha_3$ — угол сопряжения звездного датчика и ИНС относительно оси Z;


### Матрица перехода от ИСК к ЗПСК

Матрица перехода определяется преобразованием ИСК в ЗПСК следующим образом:

$$
M_{ИСК}^{ЗПСК}= 
\begin{pmatrix}
M_{11}^{ИСК\to ЗПСК} & M_{12}^{ИСК\to ЗПСК} & M_{13}^{ИСК\to ЗПСК} \\
M_{21}^{ИСК\to ЗПСК} & M_{22}^{ИСК\to ЗПСК} & M_{23}^{ИСК\to ЗПСК} \\
M_{31}^{ИСК\to ЗПСК} & M_{32}^{ИСК\to ЗПСК} & M_{33}^{ИСК\to ЗПСК}
\end{pmatrix}
$$

где:
- $$ M_{11}^{ИСК\to ЗПСК} = - \cos Az \cdot \sin \alpha - \sin Az \cdot \cos \alpha \cdot \sin \delta $$
- $$ M_{12}^{ИСК\to ЗПСК} = \cos Az \cdot \cos \alpha - \sin Az \cdot \sin \alpha \cdot \sin \delta $$
- $$ M_{13}^{ИСК\to ЗПСК} = \sin Az \cdot \cos \delta $$
- $$ M_{21}^{ИСК\to ЗПСК} = \sin Az \cdot \sin \alpha - \cos Az \cdot \cos \alpha \cdot \sin \delta $$
- $$ M_{22}^{ИСК\to ЗПСК} = - \sin Az \cdot \cos \alpha - \cos Az \cdot \sin \alpha \cdot \sin \delta $$
- $$ M_{23}^{ИСК\to ЗПСК} = \cos Az \cdot \cos \delta $$
- $$ M_{31}^{ИСК\to ЗПСК} = \cos \alpha \cdot \cos \delta $$
- $$ M_{32}^{ИСК\to ЗПСК} = \sin \alpha \cdot \cos \delta $$
- $$ M_{33}^{ИСК\to ЗПСК} = \sin \delta $$

#### Параметры:
- $\alpha$ — угол прямого восхождения;
- $\delta$ — угол склонения;
- $\Az$ — азимут.


### Матрица перехода от ИСК к ГСК

Определение матрицы учёта суточного вращения Земли на основании поправки истинного гринвичского времени — матрица перехода от инерциальной системы координат (ИСК) к геоцентрической системе координат (ГСК):

$$
{M_{ИСК}^{ГСК}} = 
\begin{pmatrix}
\cos S & \sin S & 0 \\
-\sin S & \cos S & 0 \\
0 & 0 & 1
\end{pmatrix}
$$

#### Параметры:
- $\S$ — истинное гринвичское время на момент $\t$.


В правой часть основного уравнения астронавигации осуществляется коррекция выходных параметров АИНС по широте, долготе и курсу (режим 2 - `correction`). 

Элементы матрицы $M_{ГСК}^{МСК}$:

$$
M_{ГСК}^{МСК} = \begin{pmatrix}
-\sin \lambda & \cos \lambda & 0 \\
\sin \varphi \cdot \cos \lambda & -\sin \varphi \cdot \sin \lambda & \cos \varphi \\
\cos \varphi \cdot \cos \lambda & \cos \varphi \cdot \sin \lambda & \sin \varphi
\end{pmatrix}
$$

являются функциями широты и долготы, имеем:

$$
\varphi = \arcsin \left( C_\psi \cdot M_{ГСК}^{МСК} \right)_{33}
$$

$$
\lambda = \arctan \frac{\left( C_\psi \cdot M_{ГСК}^{МСК} \right)_{32}}{\left( C_\psi \cdot M_{ГСК}^{МСК} \right)_{31}}
$$

$$
\psi = \arctan \frac{\left( C_\psi \cdot M_{ГСК}^{МСК} \right)_{13}}{\left( C_\psi \cdot M_{ГСК}^{МСК} \right)_{23}} 
$$

### Логика выбора режима:

1. Программа запрашивает у пользователя режим работы: `astro_inertial` или `correction`.

2. Если пользователь вводит `astro_inertial`, запускается процесс вычисления астроинерциальной матрицы.

3. Если вводится `correction`, запускается процесс вычисления коррекционной матрицы.

4. Если введено неправильное значение, программа выводит ошибку.


### Режим "astro_inertial"

1. Программа запрашивает у пользователя следующие параметры:
   - `theta` (в градусах)
   - `roll` (в градусах)
   - `alpha_1`(в градусах)
   - `alpha_2`(в градусах)
   - `alpha_3` (в градусах)
   - `alpha` (в градусах)
   - `delta` (в градусах)
   - `azimut` (в градусах)
   - `s` (в градусах)

2. Все параметры преобразуются из градусов в радианы с помощью встроенной функции `degreesToRadians`.

3. Вызывается функция `astro_inertial_mode`, которая вычисляет **AstroinertialMatrix** (астроинерциальную матрицу), которая используется для дальнейших навигационных вычислений широты φ, долготы λ и курса ψ.

4. На основе вычисленной матрицы программа вызывает функцию `computeNavigationData`, которая возвращает объект структуры `NavigationData`.

5. Все параметры структуры `NavigationData` преобразуются из радиан в градусы с помощью встроенной функции `RadiansToDegrees`.

6. Результаты навигационных вычислений широты φ, долготы λ и курса ψ выводятся на экран с помощью метода `print` объекта `NavigationData`.


### Режим "correction"

1. Программа запрашивает у пользователя следующие параметры:
   - `psi` (в градусах)
   - `lambda` (в градусах)
   - `phi` (в градусах)

2. Все параметры преобразуются из градусов в радианы с помощью функции `degreesToRadians`.

3. Вызывается функция `correction_mode`, которая вычисляет **CorrectionMatrix** (коррекционную матрицу), которая используется для дальнейших навигационных вычислений широты φ, долготы λ и курса ψ.

4. Программа использует функцию `computeNavigationData` для получения навигационной информации на основе **CorrectionMatrix**.

5. Все параметры структуры `NavigationData` преобразуются из радиан в градусы с помощью встроенной функции `RadiansToDegrees`.

6. Результаты навигационных вычислений широты φ, долготы λ и курса ψ выводятся на экран с помощью метода `print` объекта `NavigationData`.


## Пример работы программы:

### Входные данные:
```
Enter mode (astro or correction): astro
Enter theta (in degrees): 45
Enter roll (in degrees): 30
Enter alpha_1 (in degrees): 10
Enter alpha_2 (in degrees): 20
Enter alpha_3 (in degrees): 30
Enter alpha (in degrees): 5
Enter delta (in degrees): 60
Enter azimut (in degrees): 90
Enter s (in degrees): 1.0
```

### Вывод:
```
Navigation Data:
... (данные вычисленного результата) ...
```

## Примечания:
- Программа не полагается на сторонние библиотеки для вычисления матриц, а полагается на самописные классы и служебные функции.
- Основные функции для расчета находятся в файлах `AstroInertialModeResultMatrix.cpp`, `CoorectionModeResultMatrix.cpp`.
- Результат работы сохраняется в объектах класса `NavigationData`.
